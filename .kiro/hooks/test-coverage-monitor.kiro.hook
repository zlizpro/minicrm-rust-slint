{
  "enabled": true,
  "name": "测试覆盖率监控",
  "description": "代码变更后自动运行相关测试并检查覆盖率，支持Rust、Swift、Python和Node.js项目",
  "version": "1",
  "when": {
    "type": "fileEdited",
    "patterns": [
      "**/*.rs",
      "**/*.swift",
      "**/*.py",
      "**/*.ts"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "📊 检测到代码文件变更，开始执行测试覆盖率检查。请根据项目类型运行相应的测试命令：\n\n如果是Rust项目（存在Cargo.toml）：\n- 运行 `cargo test --quiet` 执行测试\n- 可选择运行 `cargo tarpaulin` 生成覆盖率报告\n\n如果是Swift项目（存在Package.swift）：\n- 运行 `swift test` 执行测试\n- 可选择运行 `swift test --enable-code-coverage` 生成覆盖率\n\n如果是Python项目（存在requirements.txt或setup.py）：\n- 运行 `python -m pytest --quiet` 执行测试\n- 可选择运行 `python -m pytest --cov` 生成覆盖率报告\n\n如果是Node.js项目（存在package.json）：\n- 运行 `npm test` 执行测试\n- 可选择运行 `npm run test:coverage` 生成覆盖率报告\n\n请执行相应的测试命令并报告结果。如果测试失败，请分析失败原因并提供修复建议。"
  }
}